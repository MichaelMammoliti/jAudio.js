function playAudio(){var e=tracksDir+addZero(defaultTrack,2)+".mp3",r=iconsFolder+"pause.png";""===audio.getAttribute("src")&&(audio.src=e),audio.play(),audioState="play",changeBackgroundImage(play,r),timer=setInterval(updateTime,100)}function pauseAudio(){var e=projectDir+"icons/"+colorThemeDefault+"/play.png";audio.pause(),audioState="pause",changeBackgroundImage(play,e),clearInterval(timer)}function stopAudio(){audio.currentTime=0,clearInterval(timer)}function updateActiveTrack(e){tracks.children[e-1].classList.add("active")}function changeSong(e){currentTrack=parseInt(e);for(var r,t=tracksDir+addZero(currentTrack,2)+".mp3",a=0;a<playlist.length;a++)tracks.children[a].removeAttribute("class");r=artworksFolder+addZero(currentTrack,2)+".jpg",audio.src=t,artwork.src=r,updateActiveTrack(currentTrack),changeBackgroundImage(artwork,r),changeBackgroundImage(document.body,r),"play"===audioState&&playAudio()}function getAudioSeconds(e){var r=e%60;return r=addZero(Math.floor(r),2),60>r?r:"00"}function getAudioMinutes(e){var r=e/60;return r=addZero(Math.floor(r),2),60>r?r:"00"}function addZero(e,r){for(var e=String(e);e.length<r;)e="0"+e;return e}function removeZero(e,r){for(var e=String(e),t=0;r>t&&"0"===e[0];)e=e.substr(1,e.length),t++;return e}function insertDOMElement(e,r){e.insertAdjacentHTML("beforeend",r)}function createTrackItem(e,r,t,a){var o="";return o+="<artwork style='background-image: url(\""+a+"\")'></artwork>",o+="<span>"+e+". "+t+" - "+r+"</span>"}function populateTrack(){for(var e,r,t,a,o,n=0;n<tracks.children.length;n++)e=tracks.children[n],r=e.getAttribute("trackname"),t=e.getAttribute("trackartist"),a=e.getAttribute("trackartwork"),o={title:r,artist:t,artwork:a},playlist.push(o),insertDOMElement(e,createTrackItem(addZero(n+1,2),playlist[n].title,playlist[n].artist,artworksFolder+playlist[n].artwork)),e.removeAttribute("trackname"),e.removeAttribute("trackartist"),e.removeAttribute("trackartwork"),e.setAttribute("tracknum",n+1)}function changeBackgroundImage(e,r){e.style.backgroundImage="url('"+r+"')"}function updateProgressBarPosition(){var e=100*audio.currentTime/duration+"%",r=progressBar.children[0];r.style.width=e}function updateTime(){var e=getAudioMinutes(audio.currentTime)+":"+getAudioSeconds(audio.currentTime);updateProgressBarPosition(),elapsedTime.innerHTML=e,audio.ended&&(currentTrack===playlist.length?(currentTrack=defaultTrack,changeSong(currentTrack)):(currentTrack+=1,changeSong(currentTrack)),autoRepeat&&playAudio())}var play=document.querySelector("#play"),prev=document.querySelector("#prev"),next=document.querySelector("#next"),stop=document.querySelector("#stop"),elapsedTime=document.querySelector("#elapsedtime"),totalTime=document.querySelector("#totaltime"),progressBar=document.querySelector("#progressbar"),audioControls=document.querySelector("#controls"),audio=document.querySelector("#mytrack"),tracks=document.querySelector("#tracks"),artwork=document.querySelector("#artwork"),background=document.querySelector("#background"),timer,volume=audio.volume=.4,colorTheme="green",colorThemeDefault="azure",projectDir="http://michaelmammoliti.com/_projects/audioJS/",tracksDir=projectDir+"songs/",artworksFolder=projectDir+"artworks/",iconsFolder=projectDir+"icons/"+colorTheme+"/",defaultTrack=1,currentTrack=defaultTrack,playlist=[],duration,audioState="pause",autoPlay=!0,autoRepeat=!0;populateTrack(),window.onload=function(){changeSong(defaultTrack)},audio.addEventListener("loadedmetadata",function(){var e=getAudioMinutes(duration)+":"+getAudioSeconds(duration);duration=audio.duration,totalTime.innerHTML=e}),play.addEventListener("click",function(){"pause"===audioState?(playAudio(),updateActiveTrack(currentTrack)):"play"===audioState&&pauseAudio()}),stop.addEventListener("click",function(){stopAudio(),pauseAudio(),updateTime()}),prev.addEventListener("click",function(){currentTrack>1?(stopAudio(),changeSong(currentTrack-1)):1===currentTrack&&(stopAudio(),changeSong(currentTrack))}),next.addEventListener("click",function(){currentTrack<playlist.length?(stopAudio(),updateTime(),changeSong(currentTrack+1),console.log(currentTrack)):(currentTrack=1,changeSong(currentTrack))}),progressBar.addEventListener("click",function(e){var r,t,a;e.offsetX&&(r=e.offsetX),void 0==r&&e.layerX&&(r=e.layerX),t=r/progressBar.offsetWidth,a=audio.duration*t,audio.currentTime=a,updateProgressBarPosition()});for(var i=0;i<playlist.length;i++)tracks.children[i].addEventListener("click",function(){var e=this,r=parseInt(e.getAttribute("tracknum"));"active"!==e.classList[0]&&(tracks.children[1].removeAttribute("class"),e.classList.add("active"),changeSong(r))});for(var i=0;i<audioControls.children.length;i++)audioControls.children[i].addEventListener("mousedown",function(){var e=this,r=iconsFolder+e.id+".png";if(changeBackgroundImage(e,r),"shadow"!==e.classList[0])for(var t=0;t<audioControls.children.length;t++)audioControls.children[t].classList.remove("shadow")}),audioControls.children[i].addEventListener("mouseup",function(){var e=this,r=projectDir+"icons/"+colorThemeDefault+"/"+e.id+".png";changeBackgroundImage(e,r)});